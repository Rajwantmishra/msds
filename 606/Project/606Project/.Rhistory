mkt_s <-    bind_rows(
Q1_17[sample(nrow(Q1_17),200),],
Q2_17[sample(nrow(Q2_17),200),],
Q3_17[sample(nrow(Q3_17),200),],
Q4_17[sample(nrow(Q4_17),200),],
Q1_18[sample(nrow(Q1_18),200),],
Q2_18[sample(nrow(Q2_18),200),],
Q3_18[sample(nrow(Q3_18),200),],
Q4_18[sample(nrow(Q4_18),200),])
head(mkt_s[which(is.na(mkt_s$Customer)),])
unique(mkt_s$Qt)
mkt_s <- left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
ggplot(mkt_s, mapping = aes(x= as.character(mkt_s$`Promotion Order Doll`), y= mkt_s$`Order Quantity`, color= mkt_s$`External Description`))+
geom_point()+theme(axis.text.x = element_text(angle = 70, hjust = 1)) + facet_wrap(~mkt_s$Qt)
sample2 <- mkt_Data %>% sample_frac(0.33)
mkt_s <- mkt_Data %>% sample_frac(0.33)
head(mkt_s[which(is.na(mkt_s$Customer)),])
unique(mkt_s$Qt)
mkt_s <- mkt_s[which(!is.na(mkt_s$Customer)),]
unique(mkt_s$Qt)
mkt_s <- left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
unique(mkt_s$Qt)
ggplot(mkt_s, mapping = aes(x= as.character(mkt_s$`Promotion Order Doll`), y= mkt_s$`Order Quantity`, color= mkt_s$`External Description`))+
geom_point()+theme(axis.text.x = element_text(angle = 70, hjust = 1)) + facet_wrap(~mkt_s$Qt)
mkt_s <- mkt_Data %>% sample_frac(0.10)
mkt_s <- mkt_Data %>% sample_frac(0.05)
head(mkt_s[which(is.na(mkt_s$Customer)),])
unique(mkt_s$Qt)
mkt_s <- mkt_s[which(!is.na(mkt_s$Customer)),]
mkt_s <- mkt_s[which(!is.na(mkt_s$Customer)),]
unique(mkt_s$Qt)
mkt_s <- left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
unique(mkt_s$Qt)
ggplot(mkt_s, mapping = aes(x= as.character(mkt_s$`Promotion Order Doll`), y= mkt_s$`Order Quantity`, color= mkt_s$`External Description`))+
geom_point()+theme(axis.text.x = element_text(angle = 70, hjust = 1)) + facet_wrap(~mkt_s$Qt)
# mkt_s <- sample_n(mkt_Data, size = 5000, replace = FALSE)
mkt_s <-    bind_rows(
Q1_17[sample(nrow(Q1_17),200),],
Q2_17[sample(nrow(Q2_17),200),],
Q3_17[sample(nrow(Q3_17),200),],
Q4_17[sample(nrow(Q4_17),200),],
Q1_18[sample(nrow(Q1_18),200),],
Q2_18[sample(nrow(Q2_18),200),],
Q3_18[sample(nrow(Q3_18),200),],
Q4_18[sample(nrow(Q4_18),200),])
head(mkt_s[which(is.na(mkt_s$Customer)),])
unique(mkt_s$Qt)
mkt_s <- mkt_s[which(!is.na(mkt_s$Customer)),]
unique(mkt_s$Qt)
mkt_s <- left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
unique(mkt_s$Qt)
ggplot(mkt_s, mapping = aes(x= as.character(mkt_s$`Promotion Order Doll`), y= mkt_s$`Order Quantity`, color= mkt_s$`External Description`))+
geom_point()+theme(axis.text.x = element_text(angle = 70, hjust = 1)) + facet_wrap(~mkt_s$Qt)
mkt_s
mkt_s
nrow(mkt_s)
# mkt_s <- sample_n(mkt_Data, size = 5000, replace = FALSE)
mkt_s <-    bind_rows(
Q1_17[sample(nrow(Q1_17),200),],
Q2_17[sample(nrow(Q2_17),200),],
Q3_17[sample(nrow(Q3_17),200),],
Q4_17[sample(nrow(Q4_17),200),],
Q1_18[sample(nrow(Q1_18),200),],
Q2_18[sample(nrow(Q2_18),200),],
Q3_18[sample(nrow(Q3_18),200),],
Q4_18[sample(nrow(Q4_18),200),])
nrow(mkt_s)
mkt_s <- mkt_s[which(!is.na(mkt_s$Customer)),]
unique(mkt_s$Qt)
mkt_s <- left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
unique(mkt_s$Qt)
nrow(mkt_s)
View(mkt_s)
# mkt_s <- sample_n(mkt_Data, size = 5000, replace = FALSE)
mkt_s <-    bind_rows(
Q1_17[sample(nrow(Q1_17),200),],
Q2_17[sample(nrow(Q2_17),200),],
Q3_17[sample(nrow(Q3_17),200),],
Q4_17[sample(nrow(Q4_17),200),],
Q1_18[sample(nrow(Q1_18),200),],
Q2_18[sample(nrow(Q2_18),200),],
Q3_18[sample(nrow(Q3_18),200),],
Q4_18[sample(nrow(Q4_18),200),])
mkt_s <- left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
unique(mkt_s$Qt)
nrow(mkt_s)
# mkt_s <- sample_n(mkt_Data, size = 5000, replace = FALSE)
mkt_s <-    bind_rows(
Q1_17[sample(nrow(Q1_17),200),],
Q2_17[sample(nrow(Q2_17),200),],
Q3_17[sample(nrow(Q3_17),200),],
Q4_17[sample(nrow(Q4_17),200),],
Q1_18[sample(nrow(Q1_18),200),],
Q2_18[sample(nrow(Q2_18),200),],
Q3_18[sample(nrow(Q3_18),200),],
Q4_18[sample(nrow(Q4_18),200),])
mkt_s <- mkt_s[which(!is.na(mkt_s$Customer)),]
unique(mkt_s$Qt)
nrow(mkt_s)
# mkt_s <- sample_n(mkt_Data, size = 5000, replace = FALSE)
mkt_s <-    bind_rows(
Q1_17[sample(nrow(Q1_17),200),],
Q2_17[sample(nrow(Q2_17),200),],
Q3_17[sample(nrow(Q3_17),200),],
Q4_17[sample(nrow(Q4_17),200),],
Q1_18[sample(nrow(Q1_18),200),],
Q2_18[sample(nrow(Q2_18),200),],
Q3_18[sample(nrow(Q3_18),200),],
Q4_18[sample(nrow(Q4_18),200),])
head(mkt_s[which(is.na(mkt_s$Customer)),])
mkt_s <- mkt_s[which(!is.na(mkt_s$Customer)),]
head(mkt_s[which(is.na(mkt_s$Customer)),])
unique(mkt_s$Qt)
mkt_s <- left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
head(mkt_s[which(is.na(mkt_s$Customer)),])
unique(mkt_s$Qt)
head(mkt_s[which(is.na(mkt_s$KUNNR_NEW)),])
mkt_s
View(mkt_s)
# mkt_s <- sample_n(mkt_Data, size = 5000, replace = FALSE)
mkt_s <-    bind_rows(
Q1_17[sample(nrow(Q1_17),200),],
Q2_17[sample(nrow(Q2_17),200),],
Q3_17[sample(nrow(Q3_17),200),],
Q4_17[sample(nrow(Q4_17),200),],
Q1_18[sample(nrow(Q1_18),200),],
Q2_18[sample(nrow(Q2_18),200),],
Q3_18[sample(nrow(Q3_18),200),],
Q4_18[sample(nrow(Q4_18),200),])
head(mkt_s[which(is.na(mkt_s$Customer)),])
unique(mkt_s$Qt)
mkt_s <- mkt_s[which(!is.na(mkt_s$Customer)),]
unique(mkt_s$Qt)
mkt_s2 <- left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
mkt_s2
readr::write_csv(mkt_s)
readr::write_csv(mkt_s,path = .)
readr::write_csv(mkt_s,path = filePath)
write_csv(mkt_s,path = filePath)
write_excel_csv(mkt_s,path = filePath)
write_csv(mkt_s,path = file.path(dir, "mkt.csv"))
setwd("~/myR/MS/606/Project/606Project")
write_csv(mkt_s)
write_file(mkt_s)
write_file(mkt_s,path = file.path(dir, "mkt.csv"))
write_file(mkt_s,path = file.path(dir, "/mkt.csv"))
filePath
write_file(mkt_s,path = file.path(filePath, "/mkt.csv"))
write_file(mkt_s,path = paste0(filePath, "/mkt.csv"))
write_file(mkt_s,path = paste0(filePath, "mkt.csv"))
write_file(mkt_s,path = filePath)
write_file(mkt_s,path = filePath, "mkt.csv"")
write_file(mkt_s,path = filePath, "mkt.csv")
write_file(mkt_s,path = filePath, "mkt.csv")
write.csv(mkt_s,path = filePath,", "mkt.csv"")
write.file(mkt_s,path = filePath,", "mkt.csv"")
library("readr")
library("xlsx")
install.packages("xlsx")
library("xlsx")
write.xlsx(mkt_s,path = filePath,sheetName = "Sheet1",
col.names = TRUE, row.names = TRUE, append = FALSE)
write.xlsx(mkt_s,"ap.xlsx",sheetName = "Sheet1",
col.names = TRUE, row.names = TRUE, append = FALSE)
write.xlsx(mkt_s2,"ap2.xlsx",sheetName = "Sheet1",
col.names = TRUE, row.names = TRUE, append = FALSE)
# mkt_s <- sample_n(mkt_Data, size = 5000, replace = FALSE)
mkt_s <-    bind_rows(
Q1_17[sample(nrow(Q1_17),200),],
Q2_17[sample(nrow(Q2_17),200),],
Q3_17[sample(nrow(Q3_17),200),],
Q4_17[sample(nrow(Q4_17),200),],
Q1_18[sample(nrow(Q1_18),200),],
Q2_18[sample(nrow(Q2_18),200),],
Q3_18[sample(nrow(Q3_18),200),],
Q4_18[sample(nrow(Q4_18),200),])
mkt_s2 <- dplyr:: left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
mkt_s2
# mkt_s <- sample_n(mkt_Data, size = 5000, replace = FALSE)
mkt_s <-    bind_rows(
Q1_17[sample(nrow(Q1_17),200),],
Q2_17[sample(nrow(Q2_17),200),],
Q3_17[sample(nrow(Q3_17),200),],
Q4_17[sample(nrow(Q4_17),200),],
Q1_18[sample(nrow(Q1_18),200),],
Q2_18[sample(nrow(Q2_18),200),],
Q3_18[sample(nrow(Q3_18),200),],
Q4_18[sample(nrow(Q4_18),200),])
head(mkt_s[which(is.na(mkt_s$Customer)),])
unique(mkt_s$Qt)
mkt_s <- mkt_s[which(!is.na(mkt_s$Customer)),]
unique(mkt_s$Qt)
mkt_s2 <- dplyr:: left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
mkt_s2
mkt_s2 <- dplyr:: strict_left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
# mkt_s2 <- dplyr:: left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
merge(mkt_s, custmap, by = c("Customer", "KUNNR_OLD"))
mkt_s
# mkt_s2 <- dplyr:: left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
merge(mkt_s, custmap, by = c("Customer", "KUNNR_OLD"))
custmap
# mkt_s2 <- dplyr:: left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
merge(mkt_s, custmap, by = c("Customer", "KUNNR_OLD"))
# mkt_s2 <- dplyr:: left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
merge(mkt_s, custmap, by = c("Customer", "KUNNR_OLD"),by.x = Customer, by.y = KUNNR_OLD, all = FALSE,)
# mkt_s2 <- dplyr:: left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
merge(mkt_s, custmap, by = c("Customer", "KUNNR_OLD"),by.x = Customer, by.y = KUNNR_OLD, all = FALSE)
# mkt_s2 <- dplyr:: left_join(mkt_s, custmap, by = c("Customer" = "KUNNR_OLD"))
merge(mkt_s, custmap, by = c("Customer", "KUNNR_OLD"),by.x = mkt_s$Customer, by.y = custmap$KUNNR_OLD, all = FALSE)
mkt_s
mkt_s
mkt_s[,-c(1,2,4,5,6,7,8)]
mkt_s <- mkt_s[,-c(1,2,4,5,6,7,8,7)]
mkt_s
mkt_s
mkt_s %>% group_by(Customer)
cust_qt <- mkt_s %>% group_by(Customer,Qt) %>% summarise(order_unit = sum(`Order Quantity`))
cust_qt
spread(cust_qt,Qt,order_unit)
mkt_Data <- bind_rows(
Q1_17,
Q2_17,
Q3_17,
Q4_17,
Q1_18,
Q2_18,
Q3_18,
Q4_18)
head(mkt_Data)
mkt_Data
head(mkt_Data)
# upate new Acocunt info
custmap$KUNNR_OLD <- as.numeric(custmap$KUNNR_OLD)
custmap$KUNNR_NEW<- as.numeric(custmap$KUNNR_NEW)
mkt_Data <- mkt_Data[which(!is.na(mkt_Data$Customer)),]
unique(mkt_Data$Qt)
head(mkt_Data[which(is.na(mkt_Data$Customer)),])
mkt_Data
#Dropping some Text values from full data
mkt_Datalean <- mkt_Data[,-c(1,2,4,5,6,7,8,7)]
mkt_cust_qt <- mkt_Datalean %>% group_by(Customer,Qt) %>% summarise(order_unit = sum(`Order Quantity`))
mkt_cust_qt
mkt_cust_qt <- spread(mkt_cust_qt,Qt,order_unit)
mkt_cust_qt
View(mkt_cust_qt)
mkt_cust_qt <- mkt_Datalean %>% group_by(Customer,Qt) %>% summarise(order_unit = sum(`Order Quantity`))
mkt_cust_qt
custmap
left_join(mkt_cust_qt,custmap,by=c("Customer" = "KUNNR_OLD"))
nrow(mkt_cust_qt)
mutate(mkt_cust_qt,New_Acc = custmap[which(custmap$KUNNR_OLD == Customer)])
custmap
mutate(mkt_cust_qt,New_Acc = custmap[which(custmap$KUNNR_OLD == Customer),2])
mutate(mkt_cust_qt,"New_Acc" = custmap[which(custmap$KUNNR_OLD == Customer),2])
sent_by_rep <- ddply(mkt_cust_qt,.(Customer),mutate,New_Acc = as.character(custmap[which(custmap$KUNNR_OLD==Customer),c(2)]))
sent_by_rep <- plyr::ddply(mkt_cust_qt,.(Customer),mutate,New_Acc = as.character(custmap[which(custmap$KUNNR_OLD==Customer),c(2)]))
sent_by_rep <- plyr::ddply(mkt_cust_qt,(Customer),mutate,New_Acc = as.character(custmap[which(custmap$KUNNR_OLD==Customer),c(2)]))
sent_by_rep <- plyr::ddply(mkt_cust_qt,Customer,mutate,New_Acc = as.character(custmap[which(custmap$KUNNR_OLD==Customer),c(2)]))
mkt_cust_qt
sent_by_rep <- plyr::ddply(mkt_cust_qt,mkt_cust_qt$Customer,mutate,New_Acc = as.character(custmap[which(custmap$KUNNR_OLD==Customer),c(2)]))
sent_by_rep <- plyr::ddply(mkt_cust_qt,.(Customer),mutate,New_Acc = as.character(custmap[which(custmap$KUNNR_OLD==Customer),c(2)]))
sent_by_rep <- plyr::ddply(mkt_cust_qt,mkt_cust_qt$Customer,mutate,New_Acc = as.character(custmap[which(custmap$KUNNR_OLD==Customer),c(2)]))
custmap
custmap[which(custmap$KUNNR_OLD == 1212432),2]
custmap
custmap <- read_excel(path=paste0(filePath,"/","custmap.xlsx"),col_types = c("text","text"))
# upate new Acocunt info
custmap$KUNNR_OLD <- as.numeric(custmap$KUNNR_OLD)
custmap$KUNNR_NEW<- as.numeric(custmap$KUNNR_NEW)
mkt_Data
nrow(mkt_Data)
nrow(left_join(mkt_Data, custmap, by = c("Customer" = "KUNNR_OLD")))
mkt_Data <- left_join(mkt_Data, custmap, by = c("Customer" = "KUNNR_OLD"))
nrow(mkt_Data)
mkt_Data
head(mkt_Data[which(is.na(mkt_Data$KUNNR_NEW)),])
View(mkt_Data[which(is.na(mkt_Data$KUNNR_NEW)),])
mkt_Data$Customer[which(is.na(mkt_Data$KUNNR_NEW)),]
mkt_Data$Customer[which(is.na(mkt_Data$KUNNR_NEW))]
mkt_Data$KUNNR_NEW2 <- mkt_Data$KUNNR_NEW
View(mkt_Data[which(is.na(mkt_Data$KUNNR_NEW)),])
mkt_Data$KUNNR_NEW2 <- mkt_Data$Customer[which(is.na(mkt_Data$KUNNR_NEW))]
mkt_Data$KUNNR_NEW2[which(is.na(mkt_Data$KUNNR_NEW))] <- mkt_Data$Customer[which(is.na(mkt_Data$KUNNR_NEW))]
View(mkt_Data[which(is.na(mkt_Data$KUNNR_NEW)),])
rm(mkt_Data)
mkt_Data <- bind_rows(
Q1_17,
Q2_17,
Q3_17,
Q4_17,
Q1_18,
Q2_18,
Q3_18,
Q4_18)
mkt_Data <- mkt_Data[which(!is.na(mkt_Data$Customer)),]
unique(mkt_Data$Qt)
head(mkt_Data[which(is.na(mkt_Data$Customer)),])
mkt_Data <- left_join(mkt_Data, custmap, by = c("Customer" = "KUNNR_OLD"))
View(mkt_Data[which(is.na(mkt_Data$KUNNR_NEW)),])
mkt_Data$KUNNR_NEW[which(is.na(mkt_Data$KUNNR_NEW))] <- mkt_Data$Customer[which(is.na(mkt_Data$KUNNR_NEW))]
View(mkt_Data[which(is.na(mkt_Data$KUNNR_NEW)),])
mkt_Data
nrow(mkt_Data
)
mkt_Data
#Dropping some Text values from full data
mkt_Datalean <- mkt_Data[,-c(1,2,3,4,5,6,7,8,7)]
mkt_Datalean
mkt_cust_qt <- mkt_Datalean %>% group_by(Customer,Qt) %>% summarise(order_unit = sum(`Order Quantity`))
mkt_cust_qt <- mkt_Datalean %>% group_by(KUNNR_NEW,Qt) %>% summarise(order_unit = sum(`Order Quantity`))
mkt_cust_qt <- spread(mkt_cust_qt,Qt,order_unit)
mkt_cust_qt
mkt_cust_qt[sample(nrow(mkt_cust_qt),1000),]
mkt_cust_qt[sample(nrow(mkt_cust_qt),1000),]
mkt_cust_qt[sample(nrow(mkt_cust_qt),1000),]
custA <- mkt_cust_qt[sample(nrow(mkt_cust_qt),1000),]
custA
table(custA)
custA
ggplot(custA,mapping = aes(x=KUNNR_NEW)) + geom_line()
plot(custA)
custA
ggplot(custA,mapping = aes(x=KUNNR_NEW)) + geom_line(mapping = aes(y= Q1_17))
mkt_cust_qt <- mkt_Datalean %>% group_by(KUNNR_NEW,Qt) %>% summarise(order_unit = sum(`Order Quantity`))
mkt_cust_qt <- spread(mkt_cust_qt,Qt,order_unit)
custAG <- gather(custA, "Qt","order_unit")
custAG
custA
custAG <- gather(custA[,-c(1)], "Qt","order_unit")
custAG
custAG <- gather(custA, "Qt","order_unit")
custAG
custA
custAG <- gather(custA, key = "Qt",value = "order_unit")
custAG
custA
custAG <- gather(custA, key = "Qt",value = "order_unit",-KUNNR_NEW)
custAG
ggplot(custAG,mapping = aes(x=KUNNR_NEW y= order_unit)) + geom_line()
ggplot(custAG,mapping = aes(x=KUNNR_NEW ,y= order_unit)) + geom_line()
ggplot(custAG,mapping = aes(x=KUNNR_NEW ,y= order_unit)) + geom_point()
custAG
custAG$KUNNR_NEW <- as.character(custAG$KUNNR_NEW)
plot(custA)
ggplot(custAG,mapping = aes(x=KUNNR_NEW ,y= order_unit)) + geom_point()
ggplot(custAG,mapping = aes(x=KUNNR_NEW ,y= order_unit, fill=Qt)) + geom_point()
ggplot(custAG,mapping = aes(x=KUNNR_NEW ,y= order_unit, color=Qt)) + geom_point()
custAG
mkt_cust_qt
mkt_cust_qt
mkt_Datalean
ggplot(custAG,mapping = aes(x=KUNNR_NEW ,y= order_unit, color=Qt)) + geom_point()
ggplot(custAG,mapping = aes(y=KUNNR_NEW ,x= order_unit, color=Qt)) + geom_point()
custA <- mkt_cust_qt[sample(nrow(mkt_cust_qt),10),]
custAG <- gather(custA, key = "Qt",value = "order_unit",-KUNNR_NEW)
custAG$KUNNR_NEW <- as.character(custAG$KUNNR_NEW)
plot(custA)
ggplot(custAG,mapping = aes(x=KUNNR_NEW ,y= order_unit, color=Qt)) + geom_point()
ggplot(custAG,mapping = aes(y=KUNNR_NEW ,x= order_unit, color=Qt)) + geom_point()
ggplot(custAG,mapping = aes(y=KUNNR_NEW ,x= order_unit, color=Qt)) + geom_point() + facet_wrap(~Qt)
custA <- mkt_cust_qt[sample(nrow(mkt_cust_qt),1000),]
custAG <- gather(custA, key = "Qt",value = "order_unit",-KUNNR_NEW)
custAG$KUNNR_NEW <- as.character(custAG$KUNNR_NEW)
ggplot(custAG,mapping = aes(y=KUNNR_NEW ,x= order_unit, color=Qt)) + geom_point() + facet_wrap(~Qt)
ggplot(custAG,mapping = aes(y=KUNNR_NEW ,x= order_unit, color=Qt)) + geom_point() + facet_wrap(~Qt) + geom_smooth()
ggplot(custAG,mapping = aes(y=KUNNR_NEW ,x= order_unit, color=Qt)) +  facet_wrap(~Qt) + geom_smooth()
ggplot(custAG,mapping = aes(y=KUNNR_NEW ,x= order_unit, color=Qt)) + geom_point() + facet_wrap(~Qt)
custAG
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit))
custAG %>%
group_by(Qt)
custAG$order_unit[which(is.na(custAG$order_unit))]
custAG$order_unit[which(is.na(order_unit))]
custAG$order_unit[which(is.na(custAG$order_unit))]
custAG
custAG$order_unit[which(is.na(custAG$order_unit))]
custAG$order_unit[which(is.na(custAG$order_unit))] <- 0
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit))
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(y= Qt,x=order_unit,color = Qt)) + geom_poin()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(y= Qt,x=order_unit)) + geom_poin()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(y= Qt,x=order_unit,color = Qt)) + geom_point()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,color = Qt)) + geom_point()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>% order(Qt)
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit))
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>% order(.$Qt)
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>% sort(.$Qt)
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>% sort(Qt)
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>% sort("Qt")
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,color = Qt)) + geom_point()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit))
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,color = Qt)) + geom_point()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,color = Qt)) + geom_col()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit))
t <- custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit))
t
order(t,t$Qt)
ordered(t,t$Qt)
ordered(t$Qt)
ordered(t$Qt[c(1,2,3,4,5,6,7,8)])
ordered(t$Qt[c(1,3,5,7,2,4,6,8)])
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>% ordered(.$Qt[c(1,3,5,7,2,4,6,8)])
(t$Qt[c(1,3,5,7,2,4,6,8)])
ordered(t$Qt[c(1,3,5,7,2,4,6,8)])
order(t$Qt[c(1,3,5,7,2,4,6,8)])
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,color = Qt)) + geom_col()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= reorder(Qt, c(1,3,5,7,2,4,6,8)),y=order_unit,color = Qt)) + geom_col()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= reorder(Qt, c(1,2,3,4,5,6,7,8)),y=order_unit,color = Qt)) + geom_col()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= reorder(Qt, c(1,3,5,7,2,4,6,8)),y=order_unit,color = Qt)) + geom_col()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= reorder(Qt, c(1,2,3,4,5,6,7,8)),y=order_unit,color = Qt)) + geom_col()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= reorder(Qt, c(1,3,2,4,5,6,7,8)),y=order_unit,color = Qt)) + geom_col()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= reorder(Qt, c(1,3,5,2,4,6,7,8)),y=order_unit,color = Qt)) + geom_col()
"Q1_17",
"Q1_17",   "Q2_17",   "Q3_17",   "Q4_17",   "Q1_18",   "Q2_18",   "Q3_18",   "Q4_18")),y=order_unit,color = Qt)) + geom_col()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= reorder(Qt, c("Q1_17",   "Q2_17",   "Q3_17",   "Q4_17",   "Q1_18",   "Q2_18",   "Q3_18",   "Q4_18")),y=order_unit,color = Qt)) + geom_col()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= reorder(Qt, value=c("Q1_17",   "Q2_17",   "Q3_17",   "Q4_17",   "Q1_18",   "Q2_18",   "Q3_18",   "Q4_18")),y=order_unit,color = Qt)) + geom_col()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= reorder(Qt, c("Q1_17",   "Q2_17",   "Q3_17",   "Q4_17",   "Q1_18",   "Q2_18",   "Q3_18",   "Q4_18")),y=order_unit,color = Qt)) + geom_col()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,color = Qt)) + geom_col()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,color = Qt)) + geom_col() + geom_smooth()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,color = Qt)) + geom_col() + geom_smooth(method="lm")
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,fill = Qt)) + geom_col() + geom_smooth(method="lm")
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,fill = Qt)) + geom_col() + geom_smooth(method="lm") + geom_label(aes(label=Qt))
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,fill = Qt)) + geom_col() + geom_smooth(method="lm") + geom_label(aes(label=order_unit))
theme_light()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,fill = Qt)) + geom_col() + geom_smooth(method="lm") + geom_label(aes(label=order_unit)) +
theme_light()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,fill = Qt)) + geom_col() + geom_smooth(method="lm" ,se = FALSE) + geom_label(aes(label=order_unit))
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,fill = Qt)) + geom_col() + geom_line() + geom_label(aes(label=order_unit))
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,fill = Qt)) + geom_col() + geom_line() + geom_label(aes(label=order_unit)) %>%
theme_light()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,fill = Qt)) + geom_col() + geom_line() + geom_label(aes(label=order_unit))
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,fill = Qt)) + geom_col() +  geom_label(aes(label=order_unit))
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,fill = Qt)) + geom_col() +  geom_label(aes(label=order_unit)) %>%
theme_light()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,fill = Qt)) + geom_col() +  geom_label(aes(label=order_unit))+
theme_light()
custAG %>%
group_by(Qt) %>% summarise(order_unit = sum(order_unit)) %>%
ggplot(mapping = aes(x= Qt,y=order_unit,fill = Qt)) + geom_col() +  geom_label(aes(label=order_unit))
